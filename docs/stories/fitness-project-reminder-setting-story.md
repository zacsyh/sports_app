# 健身项目提醒设置功能用户故事

## 1. 用户角色

### 主要用户
- **健身爱好者**: 定期进行健身锻炼，希望跟踪和管理自己的健身进度
- **健身初学者**: 刚开始健身，需要简单易用的工具来建立健身习惯
- **自律性训练者**: 需要提醒和激励机制来保持锻炼的连续性

### 次要用户
- **健身教练**: 可能使用该应用来跟踪客户的训练计划
- **健康关注者**: 关注健康数据，希望通过数据了解自己的身体状况

## 2. 功能描述

作为一位健身用户，我希望能够为我的健身项目设置提醒，以便我可以在合适的时间收到通知，确保按时完成锻炼计划。应用基于Web平台（PWA），所有数据存储在本地浏览器中。

### 核心功能
1. 用户可以从项目详情界面点击提醒设置按钮进入项目提醒设置界面
2. 用户可以为项目设置截止时间提醒：
   - 设置项目截止日期和时间
   - 设置提醒提前时间（分钟）
   - 开启或关闭提醒功能
3. 系统会根据用户设置创建相应的提醒记录并存储在IndexedDB中
4. 用户可以保存提醒设置，保存成功后将返回项目详情界面并显示更新后的提醒状态
5. 用户可以取消设置，取消后将返回项目详情界面，不保存任何更改

## 3. 验收标准

### 功能验收标准
1. 用户可以从项目详情界面成功进入项目提醒设置界面
2. 提醒设置界面能正确加载并显示当前项目的提醒设置（如果已存在）
3. 用户可以设置项目截止日期和时间
4. 用户可以设置提醒提前时间（分钟）
5. 用户可以开启或关闭提醒功能
6. 当用户输入无效数据时，系统能显示清晰的错误提示
7. 用户可以成功保存提醒设置，保存后项目详情界面会显示更新后的提醒状态
8. 如果存储失败，系统能显示相应的错误信息
9. 用户可以取消设置，不保存任何更改并返回项目详情界面

### 性能验收标准
1. 项目提醒设置界面加载时间不超过1秒
2. 表单验证响应时间不超过200毫秒
3. 提醒设置保存操作完成时间不超过1秒

### 兼容性验收标准
1. 在主流浏览器（Chrome、Firefox、Safari、Edge）上都能正常显示和操作
2. 在深色和浅色主题下都能正确显示界面元素
3. 在不同屏幕尺寸和分辨率下都能正常显示（响应式设计）

## 4. 技术要求

### 数据模型
根据系统架构设计，提醒的数据模型应包含以下字段，数据存储在浏览器的IndexedDB中：

#### 个体项目提醒数据结构
- `id`: Number (唯一标识符)
- `projectId`: String (关联的项目ID)
- `enabled`: Boolean (是否启用)
- `deadline`: Long (截止时间戳)
- `remindBefore`: Int (提前分钟数)
- `createdAt`: Long (创建时间)
- `updatedAt`: Long (更新时间)

### 存储要求
1. 提醒数据应存储在浏览器的IndexedDB数据库中
2. 使用Dexie.js封装IndexedDB操作
3. 所有数据库操作应在Web Worker中执行，避免阻塞主线程
4. 数据库操作应通过数据存储模块统一处理
5. 支持PWA离线存储，确保应用在离线状态下仍可正常使用

### 架构要求
1. 提醒设置功能应集成在提醒通知模块中
2. 数据验证逻辑应封装在业务逻辑层
3. 数据存储操作应通过数据存储模块统一处理
4. 使用Promise/async-await处理异步操作
5. 提醒设置功能应与全局提醒设置保持一致的UI风格

### 安全要求
1. 所有提醒数据应存储在浏览器本地，确保数据安全
2. 不收集、不上传任何提醒设置信息到外部服务器
3. 提醒权限请求应遵循浏览器最佳实践，明确告知用户用途
4. 所有数据存储在浏览器本地，不上传到任何服务器

## 5. 界面设计参考

### 界面布局
#### 顶部导航栏
- 左侧：取消按钮
- 中间：标题"提醒设置"
- 右侧：保存按钮

#### 表单区域
1. **提醒开关**
   - 类型：开关控件
   - 默认状态：关闭
   - 交互：开启后显示提醒设置字段

2. **截止日期和时间设置**
   - 类型：日期时间选择器
   - 提示文字："请选择截止日期和时间"
   - 验证：必须晚于当前时间

3. **提前时间设置**
   - 类型：数字输入框
   - 提示文字："提前多少分钟提醒"
   - 默认值：30分钟
   - 验证：正整数，最大值为1440（24小时）

#### 底部操作按钮区域
- 左侧：取消按钮（次要按钮样式）
- 右侧：保存按钮（主要按钮样式）

### 视觉设计规范
#### 颜色规范
- 主色调：活力橙 (#FF6B35) - 用于主要操作按钮和激活状态
- 主要文字颜色：深灰 (#333333)
- 次要文字颜色：中灰 (#999999)
- 错误提示颜色：错误红 (#F44336)
- 输入框边框：浅灰 (#E0E0E0)
- 输入框背景：白色 (#FFFFFF)

#### 字体规范
- 标题："提醒设置" - 20px
- 表单标签：16px
- 输入框文字：16px
- 错误提示：14px

#### 间距规范
- 表单元素间距：16px
- 输入框内边距：16px
- 按钮内边距：水平16px，垂直12px

#### 组件样式
1. **输入框**
   - 背景色：#FFFFFF
   - 边框：1px #E0E0E0
   - 圆角：8px
   - 内边距：16px
   - 文字颜色：#333333
   - 提示文字颜色：#999999

2. **开关控件**
   - 激活状态：橙色滑块
   - 未激活状态：灰色滑块

3. **按钮**
   - 主要按钮：
     - 背景色：#FF6B35
     - 文字颜色：#FFFFFF
     - 圆角：8px
   - 次要按钮：
     - 背景色：#FFFFFF
     - 边框：1px #FF6B35
     - 文字颜色：#FF6B35
     - 圆角：8px

### 交互设计
1. **表单验证**
   - 实时验证用户输入
   - 输入框失去焦点时进行验证
   - 验证失败时显示红色边框和错误提示文字
   - 验证成功时显示绿色对勾图标

2. **开关交互**
   - 开关切换时有平滑的过渡动画
   - 开启后显示相关设置字段
   - 关闭后隐藏相关设置字段

3. **按钮交互**
   - 按钮点击时有CSS过渡效果
   - 按钮按下时颜色加深10%
   - 禁用按钮时透明度为50%，无点击效果

4. **页面跳转**
   - 从详情界面进入提醒设置界面：页面滑入动画
   - 保存成功后返回详情界面：页面滑出动画
   - 取消设置后返回详情界面：页面滑出动画

### 响应式设计
1. **不同屏幕尺寸适配**
   - 在大屏设备上保持合理的边距
   - 在小屏设备上优化文字显示，避免换行
   - 横屏模式下保持良好的可读性
   - 支持桌面端和移动端显示

2. **字体大小适配**
   - 遵循浏览器字体大小设置
   - 在大字体模式下保持界面可读性

3. **浏览器兼容性**
   - 支持主流浏览器的响应式设计
   - 在不同浏览器窗口尺寸下保持良好显示效果

### 错误处理
1. **表单验证错误**
   - 在相应输入框下方显示红色错误提示文字
   - 输入框显示红色边框
   - 保存按钮在存在验证错误时禁用

2. **存储错误**
   - 显示红色Toast提示
   - 提示文字："提醒设置保存失败，请重试"
   - 提供"重试"按钮

3. **权限错误**
   - 当用户未授予通知权限时，显示温和提醒
   - 提示文字："需要通知权限才能发送提醒"
   - 提供"去设置"按钮跳转到浏览器设置

4. **浏览器兼容性问题**
   - 检测浏览器对IndexedDB的支持情况
   - 如果不支持，提示用户升级浏览器
   - 对于部分功能不支持的浏览器，提供降级方案

### 成功反馈
1. **保存成功**
   - 显示绿色Toast提示："提醒设置已保存"
   - 自动返回项目详情界面
   - 详情界面显示更新后的提醒状态
   - 数据已保存到浏览器IndexedDB中
   - 如果提醒已开启，系统会定时检查提醒触发条件

2. **权限授予成功**
   - 显示绿色Toast提示："通知权限已授予"
   - 提醒设置功能可正常使用

通过以上详细的用户故事，开发团队可以清晰地理解健身项目提醒设置功能的需求、设计和技术实现要求，从而高效地完成开发工作。